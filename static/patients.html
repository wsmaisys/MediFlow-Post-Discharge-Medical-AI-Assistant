<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dummy Patients — MediFlow</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      /* Reuse main design tokens from index for consistent look */
      :root {
        --primary: #0066cc;
        --primary-dark: #004c99;
        --secondary: #e6f0fa;
        --bg-color: #f8fafc;
        --sidebar-bg: #ffffff;
        --border-color: #e2e8f0;
        --text-primary: #1e293b;
        --text-secondary: #64748b;
        --success: #10b981;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: Inter, Segoe UI, Roboto, sans-serif;
        background: var(--bg-color);
        color: var(--text-primary);
        display: flex;
        height: 100vh;
      }

      .sidebar {
        width: 280px;
        background: var(--sidebar-bg);
        border-right: 1px solid var(--border-color);
        display: flex;
        flex-direction: column;
      }
      .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .logo-icon {
        width: 32px;
        height: 32px;
        background: var(--primary);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fff;
      }
      .brand-name {
        font-weight: 700;
      }
      .new-chat-wrapper {
        padding: 15px 20px;
      }
      .new-chat-btn {
        width: 100%;
        padding: 12px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }
      .chat-history {
        padding: 10px;
        color: var(--text-secondary);
        font-size: 13px;
      }

      .main-container {
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      .top-bar {
        height: 60px;
        background: white;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
      }
      .messages-container {
        flex: 1;
        padding: 24px;
        overflow: auto;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        overflow: hidden;
      }
      th,
      td {
        padding: 10px 12px;
        border-bottom: 1px solid var(--border-color);
        text-align: left;
        vertical-align: top;
      }
      th {
        background: #f8fafc;
        font-weight: 700;
      }
      .small {
        font-size: 13px;
        color: var(--text-secondary);
      }

      .back-link {
        display: inline-block;
        padding: 8px 12px;
        background: #fff;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        color: var(--primary);
        text-decoration: none;
      }
      .container-inner {
        max-width: 1100px;
        margin: 0 auto;
      }
    </style>
  </head>
  <body>
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="logo-icon"><i class="fas fa-heart-pulse"></i></div>
        <div class="brand-name">MediFlow</div>
      </div>
      <div class="new-chat-wrapper">
        <a href="/" class="new-chat-btn"
          ><i class="fas fa-arrow-left"></i> Back to Chat</a
        >
      </div>
      <div class="chat-history">
        Dummy patient data from <code>/data/patients.json</code>
      </div>
    </div>

    <div class="main-container">
      <div class="top-bar">
        <div>
          <h2>Dummy Patients</h2>
          <div class="small">Sample patient discharge summaries for demo</div>
        </div>
        <div style="display: flex; gap: 8px; align-items: center">
          <a class="back-link" href="/api/documentation"
            ><i class="fas fa-book"></i> API Docs</a
          >
          <a class="back-link" href="/"><i class="fas fa-home"></i> Home</a>
        </div>
      </div>

      <div class="messages-container">
        <div class="container-inner">
          <table id="patientsTable" aria-describedby="patients-list">
            <thead>
              <tr>
                <th>Patient</th>
                <th>Discharge Date</th>
                <th>Primary Diagnosis</th>
                <th>Medications</th>
                <th>Follow Up</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" class="small">Loading patient data…</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      // Try to load the JSON file from the project data folder
      const dataPaths = [
        "../data/patients.json",
        "/data/patients.json",
        "data/patients.json",
      ];
      async function loadPatients() {
        let data = null;
        for (const p of dataPaths) {
          try {
            const res = await fetch(p);
            if (!res.ok) continue;
            data = await res.json();
            break;
          } catch (e) {
            // try next
          }
        }

        const tbody = document.querySelector("#patientsTable tbody");
        tbody.innerHTML = "";

        if (!data || !Array.isArray(data) || data.length === 0) {
          tbody.innerHTML =
            '<tr><td colspan="5" class="small">No patient data found.</td></tr>';
          return;
        }

        data.forEach((p) => {
          const meds = Array.isArray(p.medications)
            ? p.medications.join("<br>")
            : p.medications || "—";
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td><strong>${escapeHtml(
              p.patient_name || "—"
            )}</strong><div class="small">${escapeHtml(
            p.primary_diagnosis || ""
          )}</div></td>
            <td>${escapeHtml(p.discharge_date || "—")}</td>
            <td>${escapeHtml(p.primary_diagnosis || "—")}</td>
            <td>${meds}</td>
            <td>${escapeHtml(p.follow_up || "—")}</td>
          `;
          tbody.appendChild(tr);
        });
      }

      function escapeHtml(text) {
        if (!text && text !== 0) return "";
        const d = document.createElement("div");
        d.textContent = text;
        return d.innerHTML;
      }

      document.addEventListener("DOMContentLoaded", loadPatients);
    </script>
  </body>
</html>
